
# Table of Contents
1. [Overview](#overview)
2. [Installation](#installation)
3. [Basic Usage](#basic-usage)
4. [Example](#example)
5. [Integration with Others Tools](#integration-with-others-tools)
6. [License](#license)

## Overview
__pyemaps__ package is a collection of python modules and libraries designed for crystal transmission electron diffraction simulations and related crystallographic calculations. Main features include:

>**Crystal** : crystal data module, classes and methods loading crystal data from various sources, including diffraction patterns generation based on the crystal data and microscope and sample control parameters

>**DP** :  kinematic diffraction python class. It encapsulates diffraction pattern data generated by the Crystal class instance and diffraction pattern visualization methods such as plotting Kikuchi and HOLZ lines, and diffraction spots or disks and their indices. 

__pyemaps__ is based on the proprietary Fortran applications released as backend of [cloudEMAPS2.0](https://emaps.emlabsolutions.com). 

Future releases planned include:

>*Bloch* : dynamic Bloch wave simulation.

Check [EMlab Solution, Inc.](https://www.emlabsolutions.com) for updates and releases. We welcome comments and suggestions from our user community. For reporting any issues and requesting pyemaps improvements, or sharing scripts using __pyemaps__, please go to [our support page](https://www.emlabsolutions.com/contact/). 

We ask for your support and donation to continue to provide free software packages like this to make impact in research and education in microscopy and crystallography.  

## Installation

```
python -m pip pyemaps
```
or
 ```
 pip install pyemaps
 ```

## Basic Usage

```
from pyemaps import Crystal
from pyemaps import DP
```

## Example

Run the following on command line, after above successful installation step:

```
python sample.py
```

where sample.py is as follows:

```python
#import Crystal class from pyemaps as cryst
from pyemaps import Crystal as cryst

# create a crystal class instance and load it with builtin silican data
si = cryst.from_builtin('silicon')

# run diffraction on the crystal instance with all default controls
# parameters
si_dp = si.gen_diffPattern()

#plot and show the pattern just generated using pyemaps built-in plot function
si_dp.plot()
```

The alternative to run the above without creating sample.py:
```
python -m pyemaps --sample (-s)
```

The diffraction plot is generated with silicon crystal data built in the package:

```
crystal Silicon: dw = iso
cell 5.4307 5.4307 5.4307 90 90 90
atom si 0.125 0.125 0.125 0.4668 1.00
spg 227 2
```

and default electron microscope and sample control parameters:

```
zone axis: (0,0,1)
microscope mode: normal
microscope camera length : 1000 mm
microscope voltage: 200 kv
sample tilt: (0.0,0.0)
sample offset: (0.0,0.0)
spot size: 0.05 angstron
```

![](https://github.com/emlab-solutions/imagepypy/raw/main/kdiff_si.png?raw=True "Kinematic diffraction for silicon")

## Integration with Others Tools
If you have DigitalMicrography (referred as DM) from Gatan with python support installed on your desktop, you can copy _dm_diff.py_ from __pyemaps__ sample installation directory after pemaps installation in the right environment set for your DM. The python script in the script utilizes DM python annotations to plot the diffraction patterns generated on silicon crystal.

```python
from pyemaps import Crystal as cr

from numpy import asfortranarray as farray
from numpy import array
from emaps import dif
import numpy as np
import os, sys

import DigitalMicrograph as DM

...
```
![](https://github.com/emlab-solutions/imagepypy/blob/main/kdiff_si_dm.png?raw=True "Kinematic diffraction for silicon python script dm_diff.py")

Other sample scripts designed for you to explore pyemaps and available in samples directory:
* __si_tilt_normal.py__: spot diffraction patterns generated with silicon crystal data, plotted with _matplotlib pyplot_ module. The code also shows how a list of diffraction patterns are generated and displayed as one of electron microscope and sample control - tilt in x direction changes.

* __si_tilt_cbed.py__: The same as above with the diffraction mode set to CBED.

* __pyplot_dm_si_diff.py__: DM python script which generate and plot diffraction pattern for silicon crystal using _matplotlib pyplot_ module

* __pyplot_dm_si_diff_color.py__: Similar to the above, the plot is done in color.

## License
 __pyemaps__ is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.

* __pyemaps__ is for non-commercial use.
* __pyemaps__ is free software under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version. You should have received a copy of the GNU General Public License along with this program.  If not, see <https://www.gnu.org/licenses/>.

Contact supprort@emlabsoftware.com for any questions and requests.
